# NEAT 配置参数说明文档

本文档详细说明了 NEAT 配置文件中所有参数的含义、取值范围和建议值。

## 目录

- [NEAT 基础配置](#neat-基础配置)
- [DefaultStagnation - 停滞检测配置](#defaultstagnation---停滞检测配置)
- [DefaultReproduction - 繁殖配置](#defaultreproduction---繁殖配置)
- [DefaultSpeciesSet - 物种集合配置](#defaultspeciesset---物种集合配置)
- [DefaultGenome - 基因组配置](#defaultgenome---基因组配置)

---

## [NEAT] 基础配置

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `fitness_criterion` | str | `max` | 适应度评估准则 | `max`（最大值）<br>`min`（最小值）<br>`mean`（平均值） |
| `fitness_threshold` | float | `0.0` | 适应度阈值，达到此值停止训练 | 任意浮点数<br>`0.0` 表示不启用 |
| `pop_size` | int | `300` | 种群大小（每代个体数量） | 正整数，建议 50-500 |
| `reset_on_extinction` | bool | `False` | 当所有物种灭绝时是否重置种群 | `True` / `False` |
| `no_fitness_termination` | bool | `True` | 是否禁用基于适应度的终止条件 | `True` / `False`<br>`True` 表示只根据代数停止 |

---

## [DefaultStagnation] 停滞检测配置

用于检测物种是否停滞不前（长时间没有改进）。

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `species_fitness_func` | str | `mean` | 物种适应度计算方法 | `max`（物种内最大适应度）<br>`mean`（物种内平均适应度） |
| `max_stagnation` | int | `20` | 最大停滞代数，超过此值物种被淘汰 | 正整数，建议 10-50 |
| `species_elitism` | int | `5` | 物种精英数量，即使停滞也保留的精英个体数 | 非负整数，建议 2-10 |

---

## [DefaultReproduction] 繁殖配置

控制如何从当前代选择个体进行繁殖。

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `elitism` | int | `5` | 精英个体数量，直接保留到下一代 | 非负整数，建议 2-10 |
| `survival_threshold` | float | `0.2` | 生存阈值，每个物种保留的个体比例 | 0.0-1.0<br>0.2 表示保留前 20% |
| `min_species_size` | int | `2` | 物种最小大小，小于此值的物种被淘汰 | 正整数，建议 2-5 |

---

## [DefaultSpeciesSet] 物种集合配置

控制如何将个体划分为不同物种。

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `compatibility_threshold` | float | `3.0` | 兼容性阈值，小于此值的个体属于同一物种 | 正浮点数，建议 2.0-5.0<br>值越大，物种越少 |

**兼容性距离计算公式：**
```
兼容性距离 = (disjoint_coefficient × 不匹配基因数) / N + 
             (weight_coefficient × 权重差异)
```
其中 N 是两个基因组中较长的基因数量。

---

## [DefaultGenome] 基因组配置

### 节点激活函数选项

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `activation_default` | str | `sigmoid` | 默认激活函数 | `sigmoid`<br>`tanh`<br>`relu`<br>`identity`<br>`gauss`<br>`sin`<br>`abs` |
| `activation_mutate_rate` | float | `0.0` | 激活函数变异概率 | 0.0-1.0<br>`0.0` 表示不变异 |
| `activation_options` | str | `sigmoid` | 可用的激活函数列表（空格分隔） | 激活函数名称列表 |

### 节点聚合选项

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `aggregation_default` | str | `sum` | 默认聚合方式 | `sum`（求和）<br>`product`（乘积）<br>`max`（最大值）<br>`min`（最小值） |
| `aggregation_mutate_rate` | float | `0.0` | 聚合方式变异概率 | 0.0-1.0 |
| `aggregation_options` | str | `sum` | 可用的聚合方式列表 | 聚合方式名称列表 |

### 节点偏置（Bias）选项

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `bias_init_mean` | float | `0.0` | 偏置初始化均值 | 任意浮点数 |
| `bias_init_stdev` | float | `1.0` | 偏置初始化标准差 | 正浮点数 |
| `bias_init_type` | str | `gaussian` | 偏置初始化类型 | `gaussian`（高斯分布）<br>`uniform`（均匀分布）<br>`constant`（常数） |
| `bias_max_value` | float | `30.0` | 偏置最大值 | 任意浮点数 |
| `bias_min_value` | float | `-30.0` | 偏置最小值 | 任意浮点数 |
| `bias_mutate_power` | float | `0.5` | 偏置变异强度（标准差倍数） | 正浮点数，建议 0.1-1.0 |
| `bias_mutate_rate` | float | `0.7` | 偏置变异概率 | 0.0-1.0 |
| `bias_replace_rate` | float | `0.1` | 偏置替换概率（完全随机替换） | 0.0-1.0 |

### 基因组兼容性选项

用于计算两个基因组的兼容性距离。

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `compatibility_disjoint_coefficient` | float | `1.0` | 不匹配基因的权重系数 | 正浮点数，建议 0.5-2.0 |
| `compatibility_weight_coefficient` | float | `0.5` | 权重差异的权重系数 | 正浮点数，建议 0.1-1.0 |

**说明：**
- 值越大，结构差异对兼容性距离的影响越大
- 通常 `disjoint_coefficient` > `weight_coefficient`

### 连接添加/删除概率

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `conn_add_prob` | float | `0.6` | 添加新连接的概率 | 0.0-1.0<br>建议 0.2-0.8 |
| `conn_delete_prob` | float | `0.5` | 删除连接的概率 | 0.0-1.0<br>建议 0.1-0.6 |

### 连接启用选项

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `enabled_default` | bool | `True` | 新连接默认是否启用 | `True` / `False` |
| `enabled_mutate_rate` | float | `0.01` | 连接启用/禁用状态变异概率 | 0.0-1.0<br>通常较小，如 0.01-0.05 |

### 网络结构选项

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `feed_forward` | bool | `False` | 是否只允许前馈连接（无循环） | `True`（前馈）<br>`False`（允许循环/递归） |
| `initial_connection` | str | `full_nodirect` | 初始连接方式 | `full`（全连接，包括自环）<br>`full_nodirect`（全连接，无自环）<br>`partial_direct X`（部分直接连接，X为概率）<br>`partial_nodirect X`（部分非直接连接，X为概率）<br>`unconnected`（无连接） |

### 节点添加/删除概率

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `node_add_prob` | float | `0.5` | 添加新节点的概率 | 0.0-1.0<br>建议 0.1-0.6 |
| `node_delete_prob` | float | `0.2` | 删除节点的概率 | 0.0-1.0<br>建议 0.05-0.3 |

**说明：**
- 添加节点通常比删除节点概率高，以鼓励网络增长
- 过高的添加概率可能导致网络过大

### 网络参数

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `num_hidden` | int | `0` | 初始隐藏节点数量 | 非负整数<br>`0` 表示从无隐藏节点开始 |
| `num_inputs` | int | `{num_inputs}` | 输入节点数量（运行时替换） | 正整数 |
| `num_outputs` | int | `{num_outputs}` | 输出节点数量（运行时替换） | 正整数 |

**说明：**
- `num_inputs` 和 `num_outputs` 在运行时由代码自动替换
- `num_hidden` 控制初始网络复杂度

### 节点响应（Response）选项

响应值用于缩放节点输出。

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `response_init_mean` | float | `1.0` | 响应初始化均值 | 任意浮点数，通常 1.0 |
| `response_init_stdev` | float | `0.0` | 响应初始化标准差 | 非负浮点数 |
| `response_init_type` | str | `gaussian` | 响应初始化类型 | `gaussian`<br>`uniform`<br>`constant` |
| `response_max_value` | float | `30.0` | 响应最大值 | 正浮点数 |
| `response_min_value` | float | `-30.0` | 响应最小值 | 负浮点数 |
| `response_mutate_power` | float | `0.0` | 响应变异强度 | 非负浮点数 |
| `response_mutate_rate` | float | `0.0` | 响应变异概率 | 0.0-1.0 |
| `response_replace_rate` | float | `0.0` | 响应替换概率 | 0.0-1.0 |

**说明：**
- 如果 `response_mutate_rate = 0.0`，响应值在进化过程中保持不变
- 某些实现中响应值固定为 1.0

### 连接权重选项

| 参数 | 类型 | 默认值 | 说明 | 取值范围 |
|------|------|--------|------|----------|
| `weight_init_mean` | float | `0.0` | 权重初始化均值 | 任意浮点数，通常 0.0 |
| `weight_init_stdev` | float | `1.0` | 权重初始化标准差 | 正浮点数，建议 0.5-2.0 |
| `weight_init_type` | str | `gaussian` | 权重初始化类型 | `gaussian`（高斯分布）<br>`uniform`（均匀分布）<br>`constant`（常数） |
| `weight_max_value` | float | `30.0` | 权重最大值 | 正浮点数 |
| `weight_min_value` | float | `-30.0` | 权重最小值 | 负浮点数 |
| `weight_mutate_power` | float | `0.6` | 权重变异强度（标准差倍数） | 正浮点数，建议 0.1-1.0 |
| `weight_mutate_rate` | float | `0.8` | 权重变异概率 | 0.0-1.0，通常较高 |
| `weight_replace_rate` | float | `0.1` | 权重替换概率（完全随机替换） | 0.0-1.0 |

**说明：**
- `weight_mutate_rate` 通常设置较高（0.7-0.9），因为权重是主要的学习参数
- `weight_replace_rate` 提供探索新权重空间的机会

---

## 参数调整建议

### 提高网络复杂度
- 增加 `num_hidden`（如 1-5）
- 提高 `node_add_prob`（如 0.3-0.6）
- 降低 `node_delete_prob`（如 0.1-0.2）

### 减少物种数量
- 提高 `compatibility_threshold`（如 4.0-5.0）
- 降低 `compatibility_disjoint_coefficient`（如 0.5-0.8）
- 降低 `compatibility_weight_coefficient`（如 0.3-0.5）

### 加快收敛速度
- 提高 `elitism`（如 5-10）
- 降低 `conn_add_prob` 和 `node_add_prob`
- 提高 `weight_mutate_rate`（如 0.8-0.9）

### 增加多样性
- 降低 `compatibility_threshold`（如 2.0-3.0）
- 提高 `conn_add_prob` 和 `node_add_prob`
- 降低 `elitism`（如 2-5）


