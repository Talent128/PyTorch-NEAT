# PyTorch-NEAT ç½‘ç»œç±»å‹è¯¦ç»†è¯´æ˜æ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [ç½‘ç»œç±»å‹å¯¹æ¯”](#ç½‘ç»œç±»å‹å¯¹æ¯”)
3. [è¯¦ç»†è¯´æ˜](#è¯¦ç»†è¯´æ˜)
   - [RecurrentNet - é€’å½’ç¥ç»ç½‘ç»œ](#recurrentnet---é€’å½’ç¥ç»ç½‘ç»œ)
   - [AdaptiveLinearNet - è‡ªé€‚åº”çº¿æ€§ç½‘ç»œ](#adaptivelinearnet---è‡ªé€‚åº”çº¿æ€§ç½‘ç»œ)
   - [AdaptiveNet - è‡ªé€‚åº”é€’å½’ç½‘ç»œ](#adaptivenet---è‡ªé€‚åº”é€’å½’ç½‘ç»œ)
4. [ä¸NEATåŸºå› ç»„çš„å…³ç³»](#ä¸neatåŸºå› ç»„çš„å…³ç³»)
5. [ç»Ÿä¸€æ¥å£è®¾è®¡](#ç»Ÿä¸€æ¥å£è®¾è®¡)
6. [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
7. [æ€§èƒ½å¯¹æ¯”](#æ€§èƒ½å¯¹æ¯”)
8. [é€‰æ‹©æŒ‡å—](#é€‰æ‹©æŒ‡å—)

---

## æ¦‚è¿°

PyTorch-NEAT æä¾›äº†ä¸‰ç§ä¸åŒç±»å‹çš„ç¥ç»ç½‘ç»œï¼Œå®ƒä»¬éƒ½å¯ä»¥ä¸NEATç®—æ³•ç»“åˆä½¿ç”¨ï¼Œä½†åœ¨ç»“æ„ã€èƒ½åŠ›å’Œé€‚ç”¨åœºæ™¯ä¸Šå„æœ‰ç‰¹ç‚¹ã€‚

### æ ¸å¿ƒåŒºåˆ«

| ç»´åº¦ | RecurrentNet | AdaptiveLinearNet | AdaptiveNet |
|------|--------------|-------------------|-------------|
| **æ‹“æ‰‘ç»“æ„** | è¾“å…¥â†’éšè—â†’è¾“å‡º | è¾“å…¥â†’è¾“å‡º | è¾“å…¥â†’éšè—â†’è¾“å‡º |
| **æƒé‡æ¥æº** | ç›´æ¥ç¼–ç ï¼ˆNEATï¼‰ | CPPNç”Ÿæˆ | CPPNç”Ÿæˆ |
| **è‡ªé€‚åº”æ€§** | âŒ å›ºå®š | âœ… åŠ¨æ€æ›´æ–° | âœ… åŠ¨æ€æ›´æ–° |
| **è®°å¿†æœºåˆ¶** | éšè—å±‚çŠ¶æ€ | æƒé‡å˜åŒ– | éšè—å±‚çŠ¶æ€+æƒé‡å˜åŒ– |
| **è®¡ç®—å¤æ‚åº¦** | ä½ | ä¸­ | é«˜ |
| **è®­ç»ƒé€Ÿåº¦** | å¿« | ä¸­ | æ…¢ |

---

## ç½‘ç»œç±»å‹å¯¹æ¯”

### ğŸ“Š è¯¦ç»†å¯¹æ¯”è¡¨

| ç‰¹æ€§ | RecurrentNet | AdaptiveLinearNet | AdaptiveNet |
|------|-------------|-------------------|-------------|
| **éšè—å±‚** | âœ… æœ‰ | âŒ æ—  | âœ… æœ‰ |
| **å¾ªç¯è¿æ¥** | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ |
| **è‡ªé€‚åº”æƒé‡** | âŒ å›ºå®š | âœ… åŠ¨æ€ | âœ… åŠ¨æ€ |
| **ç©ºé—´ç¼–ç ** | âŒ æ—  | âœ… ä½¿ç”¨ | âœ… ä½¿ç”¨ |
| **CPPN** | âŒ ä¸ä½¿ç”¨ | âœ… 1ä¸ª | âœ… 6ä¸ª |
| **å‚æ•°é‡** | ç›´æ¥ç¼–ç  | é—´æ¥ç¼–ç  | é—´æ¥ç¼–ç  |
| **è¡¨è¾¾èƒ½åŠ›** | ä¸­ç­‰ | æœ‰é™ | å¼ºå¤§ |
| **åœ¨çº¿å­¦ä¹ ** | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ | âœ… æ”¯æŒ |
| **å…ƒå­¦ä¹ ** | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ | âœ… æ”¯æŒ |
| **GPUåŠ é€Ÿ** | âœ… æ”¯æŒ | âœ… æ”¯æŒ | âœ… æ”¯æŒ |
| **æ‰¹é‡å¤„ç†** | âœ… æ”¯æŒ | âœ… æ”¯æŒ | âœ… æ”¯æŒ |

### ğŸ’¡ é€‰æ‹©å»ºè®®

```
ç®€å•ä»»åŠ¡ï¼ˆCartPoleç­‰ï¼‰
    â†’ RecurrentNet
    - è®­ç»ƒæœ€å¿«
    - å®ç°ç®€å•
    - è¶³å¤Ÿè§£å†³é—®é¢˜

éœ€è¦çŸ­æœŸè®°å¿†ï¼ˆT-Mazeç­‰ï¼‰
    â†’ AdaptiveLinearNet
    - è‡ªé€‚åº”èƒ½åŠ›
    - è®¡ç®—é€‚ä¸­
    - é€‚åˆè®°å¿†ä»»åŠ¡

å¤æ‚ä»»åŠ¡ï¼ˆå¤šæ™ºèƒ½ä½“ã€é•¿æœŸè§„åˆ’ç­‰ï¼‰
    â†’ AdaptiveNet
    - æœ€å¼ºèƒ½åŠ›
    - è®­ç»ƒè¾ƒæ…¢
    - é€‚åˆç ”ç©¶

èµ„æºå—é™
    â†’ RecurrentNet > AdaptiveLinearNet > AdaptiveNet

ç ”ç©¶è‡ªé€‚åº”æœºåˆ¶
    â†’ AdaptiveLinearNet æˆ– AdaptiveNet
```

---

## è¯¦ç»†è¯´æ˜

### RecurrentNet - é€’å½’ç¥ç»ç½‘ç»œ

#### ğŸ“ åŸºæœ¬ä¿¡æ¯

**æ–‡ä»¶ä½ç½®**: `pytorch_neat/recurrent_net.py`

**æ ¸å¿ƒæ€æƒ³**: æ ‡å‡†çš„é€’å½’ç¥ç»ç½‘ç»œå®ç°ï¼Œæ”¯æŒä»»æ„æ‹“æ‰‘ç»“æ„ï¼Œæƒé‡ç›´æ¥ä»NEATåŸºå› ç»„ä¸­æå–ã€‚

#### ğŸ—ï¸ ç½‘ç»œç»“æ„

```
è¾“å…¥å±‚ (n_inputs)
   â†“
   â”œâ”€â”€â”€â”€â”€â†’ éšè—å±‚ (n_hidden) â†º (å¾ªç¯è¿æ¥)
   â”‚          â†“
   â””â”€â”€â”€â”€â”€â†’ è¾“å‡ºå±‚ (n_outputs) â†º (å¾ªç¯è¿æ¥)
```

æ”¯æŒçš„è¿æ¥ç±»å‹ï¼š
- è¾“å…¥ â†’ éšè—
- éšè— â†’ éšè—ï¼ˆå¾ªç¯ï¼‰
- è¾“å‡º â†’ éšè—ï¼ˆåé¦ˆï¼‰
- è¾“å…¥ â†’ è¾“å‡º
- éšè— â†’ è¾“å‡º
- è¾“å‡º â†’ è¾“å‡ºï¼ˆå¾ªç¯ï¼‰

#### ğŸ’» ä»£ç ç¤ºä¾‹

```python
from pytorch_neat.recurrent_net import RecurrentNet
from pytorch_neat.activations import tanh_activation

# ä»åŸºå› ç»„åˆ›å»ºç½‘ç»œ
net = RecurrentNet.create(
    genome,                      # NEATåŸºå› ç»„
    config,                      # NEATé…ç½®
    batch_size=4,                # æ‰¹é‡å¤§å°
    activation=tanh_activation,  # æ¿€æ´»å‡½æ•°
    n_internal_steps=1,          # å†…éƒ¨è¿­ä»£æ¬¡æ•°
    use_current_activs=False     # æ˜¯å¦ä½¿ç”¨å½“å‰æ¿€æ´»å€¼
)

# é‡ç½®ç½‘ç»œçŠ¶æ€
net.reset(batch_size=4)

# å‰å‘ä¼ æ’­
for step in range(max_steps):
    outputs = net.activate(states)  # states: (batch_size, n_inputs)
    # outputs: (batch_size, n_outputs)
```

#### ğŸ”‘ å…³é”®å‚æ•°

**n_internal_steps** (å†…éƒ¨è¿­ä»£æ¬¡æ•°)
- é»˜è®¤å€¼: 1
- ä½œç”¨: éšè—å±‚åœ¨å•ä¸ªæ—¶é—´æ­¥å†…è¿­ä»£çš„æ¬¡æ•°
- æ•ˆæœ: å¢åŠ å¯ä»¥æå‡è®¡ç®—èƒ½åŠ›ï¼Œä½†ä¼šå˜æ…¢
- æ¨è: ç®€å•ä»»åŠ¡ç”¨1ï¼Œå¤æ‚ä»»åŠ¡ç”¨2-5

**use_current_activs** (ä½¿ç”¨å½“å‰æ¿€æ´»)
- é»˜è®¤å€¼: False
- ä½œç”¨: è®¡ç®—è¾“å‡ºæ—¶æ˜¯å¦ä½¿ç”¨å½“å‰æ—¶åˆ»çš„éšè—å±‚æ¿€æ´»
- False: ä½¿ç”¨ä¸Šä¸€æ—¶åˆ»çš„éšè—å±‚ï¼ˆæ ‡å‡†RNNï¼‰
- True: ä½¿ç”¨å½“å‰æ—¶åˆ»çš„éšè—å±‚ï¼ˆæ›´å¿«çš„ä¿¡æ¯æµï¼‰

**activation** (æ¿€æ´»å‡½æ•°)
- é»˜è®¤å€¼: sigmoid_activation
- æ¨è: sigmoidï¼ˆè¾“å‡ºæœ‰ç•Œï¼‰ã€tanhï¼ˆé›¶ä¸­å¿ƒï¼‰ã€reluï¼ˆç¨€ç–æ¿€æ´»ï¼‰

#### âš™ï¸ å·¥ä½œåŸç†

1. **åˆå§‹åŒ–**: ä»åŸºå› ç»„æå–æ‰€æœ‰è¿æ¥å’Œæƒé‡ï¼Œæ„å»º6ä¸ªè¿æ¥çŸ©é˜µ
2. **å‰å‘ä¼ æ’­**:
   ```python
   # æ›´æ–°éšè—å±‚ï¼ˆè¿­ä»£n_internal_stepsæ¬¡ï¼‰
   hidden(t) = activation(response * (
       W_ih @ input(t) +
       W_hh @ hidden(t-1) +
       W_oh @ output(t-1)) + bias_h)
   
   # æ›´æ–°è¾“å‡ºå±‚
   output(t) = activation(response * (
       W_io @ input(t) +
       W_ho @ hidden(t) +
       W_oo @ output(t-1)) + bias_o)
   ```
3. **çŠ¶æ€ä¿å­˜**: éšè—å±‚å’Œè¾“å‡ºå±‚çš„æ¿€æ´»å€¼ä¿å­˜åˆ°ä¸‹ä¸€æ—¶é—´æ­¥

#### âœ… ä¼˜ç‚¹

- **ç®€å•ç›´è§‚**: å°±æ˜¯æ ‡å‡†çš„RNNï¼Œæ˜“äºç†è§£å’Œè°ƒè¯•
- **è®­ç»ƒå¿«é€Ÿ**: æ— CPPNå¼€é”€ï¼Œè¯„ä¼°é€Ÿåº¦æœ€å¿«
- **å†…å­˜å ç”¨å°**: åªå­˜å‚¨æƒé‡çŸ©é˜µï¼Œæ— é¢å¤–è®¡ç®—å›¾
- **ç¨³å®šå¯é **: æƒé‡å›ºå®šï¼Œè¡Œä¸ºå¯é¢„æµ‹

#### âŒ ç¼ºç‚¹

- **æ— è‡ªé€‚åº”**: æƒé‡å›ºå®šï¼Œæ— æ³•åœ¨episodeå†…å­¦ä¹ 
- **æœç´¢ç©ºé—´å¤§**: æ‰€æœ‰æƒé‡éƒ½è¦è¿›åŒ–ï¼Œå‚æ•°é‡å¤§
- **æ— å‡ ä½•è§„å¾‹**: æ— æ³•åˆ©ç”¨ç©ºé—´ç»“æ„ä¿¡æ¯

#### ğŸ¯ é€‚ç”¨åœºæ™¯

- âœ… ç®€å•æ§åˆ¶ä»»åŠ¡ï¼ˆCartPoleã€Pendulumã€LunarLanderï¼‰
- âœ… ä¸éœ€è¦åœ¨çº¿å­¦ä¹ çš„ä»»åŠ¡
- âœ… éœ€è¦å¿«é€Ÿè¯„ä¼°çš„åœºæ™¯ï¼ˆå¤§è§„æ¨¡å®éªŒï¼‰
- âœ… ä½œä¸ºbaselineæ¯”è¾ƒ
- âœ… æ•™å­¦å’Œå­¦ä¹ NEAT

---

### AdaptiveLinearNet - è‡ªé€‚åº”çº¿æ€§ç½‘ç»œ

#### ğŸ“ åŸºæœ¬ä¿¡æ¯

**æ–‡ä»¶ä½ç½®**: `pytorch_neat/adaptive_linear_net.py`

**æ ¸å¿ƒæ€æƒ³**: æ— éšè—å±‚çš„è‡ªé€‚åº”ç½‘ç»œï¼Œæƒé‡å¯ä»¥æ ¹æ®è¾“å…¥è¾“å‡ºçš„æ¿€æ´»å€¼åŠ¨æ€æ›´æ–°ï¼Œå®ç°å¿«é€Ÿé€‚åº”å’ŒçŸ­æœŸè®°å¿†ã€‚

#### ğŸ—ï¸ ç½‘ç»œç»“æ„

```
è¾“å…¥å±‚ (n_inputs)
   â†“
   W(t) - è‡ªé€‚åº”æƒé‡çŸ©é˜µ
   â†“
è¾“å‡ºå±‚ (n_outputs)

æƒé‡æ›´æ–°:
W(t+1) = W(t) + CPPN(åæ ‡, input(t), output(t), W(t))
```

ç‰¹ç‚¹ï¼š
- **æ— éšè—å±‚**: ç›´æ¥è¿æ¥è¾“å…¥å’Œè¾“å‡º
- **è‡ªé€‚åº”æƒé‡**: æ¯ä¸ªæ—¶é—´æ­¥æ ¹æ®æ¿€æ´»å€¼æ›´æ–°æƒé‡
- **ç©ºé—´ç¼–ç **: ä½¿ç”¨2Dåæ ‡è¡¨ç¤ºç¥ç»å…ƒä½ç½®
- **ç¨€ç–è¿æ¥**: åªæ›´æ–°åˆå§‹éé›¶çš„è¿æ¥

#### ğŸ’» ä»£ç ç¤ºä¾‹

```python
from pytorch_neat.adaptive_linear_net import AdaptiveLinearNet
from pytorch_neat.activations import tanh_activation, identity_activation

# å®šä¹‰ç¥ç»å…ƒç©ºé—´åæ ‡
input_coords = [
    [-1.0, 0.0],  # å·¦ä¾§ä¼ æ„Ÿå™¨
    [0.0, 0.0],   # å‰æ–¹ä¼ æ„Ÿå™¨
    [1.0, 0.0],   # å³ä¾§ä¼ æ„Ÿå™¨
    [0.0, -1.0]   # é¢å¤–è¾“å…¥ï¼ˆå¦‚é¢œè‰²ï¼‰
]
output_coords = [
    [-1.0, 0.0],  # å·¦è½¬
    [0.0, 0.0],   # å‰è¿›
    [1.0, 0.0]    # å³è½¬
]

# ä»åŸºå› ç»„åˆ›å»ºç½‘ç»œ
net = AdaptiveLinearNet.create(
    genome,
    config,
    input_coords=input_coords,
    output_coords=output_coords,
    weight_threshold=0.4,           # æƒé‡é˜ˆå€¼ï¼ˆç¨€ç–åŒ–ï¼‰
    weight_max=3.0,                 # æƒé‡æœ€å¤§å€¼
    activation=tanh_activation,     # è¾“å‡ºæ¿€æ´»å‡½æ•°
    cppn_activation=identity_activation,  # CPPNè¾“å‡ºæ¿€æ´»
    batch_size=4,
    device='cpu'
)

# é‡ç½®ç½‘ç»œ
net.reset()

# å‰å‘ä¼ æ’­ï¼ˆè‡ªåŠ¨æ›´æ–°æƒé‡ï¼‰
for step in range(max_steps):
    outputs = net.activate(states)
    # æƒé‡å·²è‡ªåŠ¨æ›´æ–°ï¼Œé€‚åº”å½“å‰æƒ…å†µ
```

#### ğŸ”‘ å…³é”®å‚æ•°

**input_coords / output_coords** (ç¥ç»å…ƒåæ ‡)
- ç±»å‹: List[List[float]]
- æ ¼å¼: [[x1, y1], [x2, y2], ...]
- ä½œç”¨: å®šä¹‰ç¥ç»å…ƒåœ¨2Dç©ºé—´ä¸­çš„ä½ç½®
- è®¾è®¡å»ºè®®:
  - æ ¹æ®ä»»åŠ¡è¯­ä¹‰æ’åˆ—ï¼ˆå¦‚ä¼ æ„Ÿå™¨çš„ç‰©ç†ä½ç½®ï¼‰
  - å¯¹ç§°å¸ƒå±€å¯èƒ½äº§ç”Ÿå¯¹ç§°è¡Œä¸º
  - èŒƒå›´é€šå¸¸åœ¨[-1, 1]ä¹‹é—´

**weight_threshold** (æƒé‡é˜ˆå€¼)
- é»˜è®¤å€¼: 0.2
- ä½œç”¨: åˆå§‹æƒé‡ç»å¯¹å€¼å°äºæ­¤å€¼çš„è¢«è®¾ä¸º0
- æ•ˆæœ: æ§åˆ¶ç½‘ç»œç¨€ç–æ€§
- æ¨è: 0.2-0.5ï¼Œå€¼è¶Šå¤§ç½‘ç»œè¶Šç¨€ç–

**weight_max** (æƒé‡æœ€å¤§å€¼)
- é»˜è®¤å€¼: 3.0
- ä½œç”¨: æƒé‡è¢«é™åˆ¶åœ¨[-weight_max, weight_max]
- æ•ˆæœ: é˜²æ­¢æƒé‡çˆ†ç‚¸
- æ¨è: 2.0-5.0

**cppn_activation** (CPPNè¾“å‡ºæ¿€æ´»)
- é»˜è®¤å€¼: identity_activation
- ä½œç”¨: å¯¹CPPNç”Ÿæˆçš„æƒé‡æ›´æ–°åº”ç”¨æ¿€æ´»å‡½æ•°
- é€‰é¡¹:
  - identity: ä¸é™åˆ¶ï¼ˆæƒé‡æ›´æ–°å¯èƒ½å¾ˆå¤§ï¼‰
  - tanh: é™åˆ¶åœ¨(-1, 1)ï¼ˆæ›´ç¨³å®šï¼‰
  - sigmoid: é™åˆ¶åœ¨(0, 1)ï¼ˆåªå¢åŠ æƒé‡ï¼‰

#### âš™ï¸ å·¥ä½œåŸç†

1. **åˆå§‹åŒ–**: ä½¿ç”¨CPPNæ ¹æ®åæ ‡ç”Ÿæˆåˆå§‹æƒé‡çŸ©é˜µ
   ```python
   W(0) = CPPN(x_in, y_in, x_out, y_out, 0, 0, 0)
   ```

2. **å‰å‘ä¼ æ’­**: è®¡ç®—è¾“å‡º
   ```python
   output(t) = activation(W(t) @ input(t))
   ```

3. **æƒé‡æ›´æ–°**: ä½¿ç”¨CPPNè®¡ç®—æ›´æ–°é‡
   ```python
   delta_w = CPPN(x_in, y_in, x_out, y_out, 
                  input(t), output(t), W(t))
   W(t+1)[expressed] = W(t)[expressed] + delta_w[expressed]
   ```

4. **ç¨€ç–æ€§ä¿æŒ**: åªåœ¨åˆå§‹éé›¶çš„è¿æ¥ä¸Šæ›´æ–°

#### âœ… ä¼˜ç‚¹

- **è‡ªé€‚åº”èƒ½åŠ›**: å¯ä»¥åœ¨episodeå†…å­¦ä¹ 
- **çŸ­æœŸè®°å¿†**: é€šè¿‡æƒé‡å˜åŒ–å­˜å‚¨ä¿¡æ¯
- **è®¡ç®—é«˜æ•ˆ**: æ— éšè—å±‚ï¼Œè®¡ç®—å¿«
- **å‚æ•°æ•ˆç‡**: CPPNé—´æ¥ç¼–ç ï¼Œå‚æ•°å°‘
- **ç©ºé—´è§„å¾‹**: åˆ©ç”¨å‡ ä½•ç»“æ„

#### âŒ ç¼ºç‚¹

- **è¡¨è¾¾èƒ½åŠ›æœ‰é™**: æ— éšè—å±‚ï¼Œæ— æ³•è¡¨ç¤ºå¤æ‚å‡½æ•°
- **æ— é•¿æœŸè®°å¿†**: æ— å¾ªç¯è¿æ¥ï¼Œè®°å¿†èƒ½åŠ›æœ‰é™
- **åæ ‡ä¾èµ–**: éœ€è¦åˆç†è®¾è®¡ç¥ç»å…ƒåæ ‡
- **ç¨€ç–é™åˆ¶**: ç½‘ç»œç»“æ„åœ¨åˆå§‹åŒ–åå›ºå®š

#### ğŸ¯ é€‚ç”¨åœºæ™¯

- âœ… éœ€è¦çŸ­æœŸè®°å¿†çš„ä»»åŠ¡ï¼ˆT-Mazeã€å»¶è¿ŸåŒ¹é…ï¼‰
- âœ… éœ€è¦å¿«é€Ÿé€‚åº”çš„ä»»åŠ¡ï¼ˆå˜åŒ–çš„ç¯å¢ƒï¼‰
- âœ… è¾“å…¥è¾“å‡ºç»´åº¦è¾ƒå°çš„ä»»åŠ¡
- âœ… ç ”ç©¶Hebbianå­¦ä¹ å’Œå…ƒå­¦ä¹ 
- âœ… èµ„æºå—é™ä½†éœ€è¦è‡ªé€‚åº”

---

### AdaptiveNet - è‡ªé€‚åº”é€’å½’ç½‘ç»œ

#### ğŸ“ åŸºæœ¬ä¿¡æ¯

**æ–‡ä»¶ä½ç½®**: `pytorch_neat/adaptive_net.py`

**æ ¸å¿ƒæ€æƒ³**: ç»“åˆé€’å½’ç»“æ„å’Œè‡ªé€‚åº”æƒé‡ï¼Œæ˜¯æœ€å¤æ‚å’Œæœ€å¼ºå¤§çš„ç½‘ç»œç±»å‹ã€‚åŒ…å«éšè—å±‚å’Œå¾ªç¯è¿æ¥ï¼Œå…¶ä¸­éšè—å±‚çš„å¾ªç¯æƒé‡å¯ä»¥åŠ¨æ€æ›´æ–°ã€‚

#### ğŸ—ï¸ ç½‘ç»œç»“æ„

```
è¾“å…¥å±‚ (n_inputs)
   â†“
   W_ih - å›ºå®šæƒé‡
   â†“
éšè—å±‚ (n_hidden) â†º W_hh(t) - è‡ªé€‚åº”å¾ªç¯æƒé‡
   â†“
   W_ho - å›ºå®šæƒé‡
   â†“
è¾“å‡ºå±‚ (n_outputs)

æƒé‡æ›´æ–°:
W_hh(t+1) = W_hh(t) + CPPN(åæ ‡, hidden(t), W_hh(t))
```

6ä¸ªCPPNèŠ‚ç‚¹ï¼š
- w_ih: ç”Ÿæˆè¾“å…¥â†’éšè—æƒé‡
- b_h: ç”Ÿæˆéšè—å±‚åç½®
- w_hh: ç”Ÿæˆéšè—â†’éšè—åˆå§‹æƒé‡
- b_o: ç”Ÿæˆè¾“å‡ºå±‚åç½®
- w_ho: ç”Ÿæˆéšè—â†’è¾“å‡ºæƒé‡
- **delta_w**: ç”Ÿæˆéšè—â†’éšè—æƒé‡æ›´æ–°è§„åˆ™ï¼ˆè‡ªé€‚åº”æ ¸å¿ƒï¼‰

#### ğŸ’» ä»£ç ç¤ºä¾‹

```python
from pytorch_neat.adaptive_net import AdaptiveNet
from pytorch_neat.activations import tanh_activation

# å®šä¹‰ç¥ç»å…ƒç©ºé—´åæ ‡
input_coords = [[-1, 0], [0, 0], [1, 0]]
hidden_coords = [[-0.5, 0.5], [0.5, 0.5]]  # 2ä¸ªéšè—ç¥ç»å…ƒ
output_coords = [[-1, 1], [0, 1], [1, 1]]

# ä»åŸºå› ç»„åˆ›å»ºç½‘ç»œ
net = AdaptiveNet.create(
    genome,
    config,
    input_coords=input_coords,
    hidden_coords=hidden_coords,
    output_coords=output_coords,
    weight_threshold=0.2,
    activation=tanh_activation,
    batch_size=4,
    device='cuda:0'  # å¯ä»¥ä½¿ç”¨GPUåŠ é€Ÿ
)

# é‡ç½®ç½‘ç»œ
net.reset()

# å‰å‘ä¼ æ’­ï¼ˆè‡ªåŠ¨æ›´æ–°å¾ªç¯æƒé‡ï¼‰
for step in range(max_steps):
    outputs = net.activate(states)
    # éšè—å±‚å¾ªç¯æƒé‡å·²è‡ªåŠ¨æ›´æ–°
```

#### ğŸ”‘ å…³é”®å‚æ•°

**input_coords / hidden_coords / output_coords** (ç¥ç»å…ƒåæ ‡)
- éœ€è¦ä¸ºä¸‰ä¸ªå±‚åˆ†åˆ«å®šä¹‰åæ ‡
- éšè—ç¥ç»å…ƒçš„åæ ‡ç‰¹åˆ«é‡è¦ï¼Œå½±å“æƒé‡æ›´æ–°è§„åˆ™
- å»ºè®®: éšè—å±‚æ”¾åœ¨è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„ç©ºé—´ä½ç½®

**weight_threshold** (æƒé‡é˜ˆå€¼)
- ä½œç”¨: æ§åˆ¶æ‰€æœ‰æƒé‡çŸ©é˜µçš„ç¨€ç–æ€§
- æ¨è: 0.1-0.3

**activation** (æ¿€æ´»å‡½æ•°)
- åŒæ—¶ç”¨äºéšè—å±‚å’Œè¾“å‡ºå±‚
- æ¨è: tanhï¼ˆé›¶ä¸­å¿ƒï¼Œé€‚åˆè‡ªé€‚åº”ï¼‰

#### âš™ï¸ å·¥ä½œåŸç†

1. **åˆå§‹åŒ–**: ä½¿ç”¨5ä¸ªCPPNç”Ÿæˆæ‰€æœ‰åˆå§‹æƒé‡çŸ©é˜µ
   ```python
   W_ih = CPPN_ih(åæ ‡, 0, 0, 0)
   W_hh = CPPN_hh(åæ ‡, 0, 0, 0)
   # ... å…¶ä»–æƒé‡
   ```

2. **å‰å‘ä¼ æ’­**: 
   ```python
   # æ›´æ–°éšè—å±‚
   hidden(t) = activation(
       W_ih @ input(t) +
       W_hh(t) @ hidden(t-1) +
       bias_h)
   
   # æ›´æ–°è¾“å‡ºå±‚
   output(t) = activation(
       W_ho @ hidden(t) +
       bias_o)
   ```

3. **æƒé‡æ›´æ–°**: æ›´æ–°éšè—å±‚å¾ªç¯æƒé‡
   ```python
   delta_w = CPPN_delta(
       åæ ‡, hidden(t), hidden(t), W_hh(t))
   W_hh(t+1) = W_hh(t) + delta_w
   ```

#### âœ… ä¼˜ç‚¹

- **æœ€å¼ºèƒ½åŠ›**: ç»“åˆéšè—å±‚ã€å¾ªç¯è¿æ¥å’Œè‡ªé€‚åº”
- **é•¿æœŸè®°å¿†**: éšè—å±‚çŠ¶æ€ + æƒé‡å˜åŒ–
- **å¤æ‚æ¨ç†**: éšè—å±‚å¯ä»¥è¿›è¡Œå¤æ‚è®¡ç®—
- **å…ƒå­¦ä¹ **: å¯ä»¥"å­¦ä¼šå­¦ä¹ "
- **çµæ´»æ€§**: é€‚åº”å„ç§å¤æ‚ä»»åŠ¡

#### âŒ ç¼ºç‚¹

- **è®­ç»ƒæœ€æ…¢**: 6ä¸ªCPPNï¼Œè®¡ç®—é‡å¤§
- **è°ƒå‚å›°éš¾**: å‚æ•°å¤šï¼Œéš¾ä»¥ä¼˜åŒ–
- **å®¹æ˜“è¿‡æ‹Ÿåˆ**: èƒ½åŠ›å¼ºï¼Œéœ€è¦å¤§é‡æ•°æ®
- **å†…å­˜å ç”¨å¤§**: éœ€è¦å­˜å‚¨å¤šä¸ªæƒé‡çŸ©é˜µ
- **éš¾ä»¥è°ƒè¯•**: è¡Œä¸ºå¤æ‚ï¼Œä¸æ˜“ç†è§£

#### ğŸ¯ é€‚ç”¨åœºæ™¯

- âœ… å¤æ‚çš„è®°å¿†ä»»åŠ¡ï¼ˆé•¿åºåˆ—ã€å¤šæ­¥æ¨ç†ï¼‰
- âœ… éå¹³ç¨³ç¯å¢ƒï¼ˆè§„åˆ™ä¼šå˜åŒ–ï¼‰
- âœ… å…ƒå­¦ä¹ ç ”ç©¶
- âœ… å¤šæ™ºèƒ½ä½“åä½œ
- âœ… æŒç»­å­¦ä¹ 
- âš ï¸ ä¸æ¨èç”¨äºç®€å•ä»»åŠ¡ï¼ˆè¿‡åº¦è®¾è®¡ï¼‰

---

## ä¸NEATåŸºå› ç»„çš„å…³ç³»

### ğŸ§¬ åŸºå› ç»„ç¼–ç æ–¹å¼

æ‰€æœ‰ä¸‰ç§ç½‘ç»œéƒ½ä½¿ç”¨NEATåŸºå› ç»„è¿›åŒ–ï¼Œä½†ç¼–ç æ–¹å¼ä¸åŒï¼š

#### RecurrentNet - ç›´æ¥ç¼–ç 

```
åŸºå› ç»„ â†’ ç½‘ç»œ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
èŠ‚ç‚¹åŸºå›  â†’ ç¥ç»å…ƒï¼ˆéšè—ã€è¾“å‡ºï¼‰
è¿æ¥åŸºå›  â†’ æƒé‡çŸ©é˜µå…ƒç´ 

ç¤ºä¾‹:
èŠ‚ç‚¹1: bias=0.5, response=1.0
èŠ‚ç‚¹2: bias=-0.3, response=2.0
è¿æ¥(0â†’1): weight=1.2
è¿æ¥(0â†’2): weight=-0.8
```

**ç‰¹ç‚¹**:
- æ¯ä¸ªæƒé‡éƒ½æ˜¯ä¸€ä¸ªå¯è¿›åŒ–çš„å‚æ•°
- æ‹“æ‰‘å’Œæƒé‡åŒæ—¶è¿›åŒ–
- æœç´¢ç©ºé—´å¤§ï¼Œä½†ç›´è§‚

#### AdaptiveLinearNet - CPPNé—´æ¥ç¼–ç 

```
åŸºå› ç»„ â†’ CPPN â†’ æƒé‡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
åŸºå› ç»„å®šä¹‰CPPNçš„æ‹“æ‰‘å’Œæƒé‡
CPPNæ¥æ”¶åæ ‡ç­‰è¾“å…¥ï¼Œç”Ÿæˆæƒé‡æ›´æ–°è§„åˆ™

ç¤ºä¾‹:
åŸºå› ç»„ç¼–ç : 10ä¸ªèŠ‚ç‚¹, 15ä¸ªè¿æ¥
ç”Ÿæˆçš„CPPNå¯ä»¥äº§ç”Ÿ: 100ä¸ªç½‘ç»œæƒé‡

CPPNè¾“å…¥: [x_in, y_in, x_out, y_out, pre, post, w]
CPPNè¾“å‡º: [delta_w]
```

**ç‰¹ç‚¹**:
- é—´æ¥ç¼–ç ï¼Œå‚æ•°æ•ˆç‡é«˜
- å¯ä»¥åˆ©ç”¨å‡ ä½•è§„å¾‹æ€§
- æœç´¢ç©ºé—´å°ï¼Œä½†éœ€è¦åˆç†çš„åæ ‡è®¾è®¡

#### AdaptiveNet - å¤šCPPNé—´æ¥ç¼–ç 

```
åŸºå› ç»„ â†’ 6ä¸ªCPPN â†’ å¤šä¸ªæƒé‡çŸ©é˜µ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä¸€ä¸ªåŸºå› ç»„åŒæ—¶ç¼–ç 6ä¸ªCPPN:
- CPPN1: ç”ŸæˆW_ih
- CPPN2: ç”Ÿæˆb_h
- CPPN3: ç”ŸæˆW_hhåˆå§‹å€¼
- CPPN4: ç”Ÿæˆb_o
- CPPN5: ç”ŸæˆW_ho
- CPPN6: ç”ŸæˆW_hhæ›´æ–°è§„åˆ™

ç¤ºä¾‹:
åŸºå› ç»„: è¾“å…¥7ä¸ªèŠ‚ç‚¹, è¾“å‡º6ä¸ªèŠ‚ç‚¹
create_cppn()è‡ªåŠ¨åˆ†ç¦»æˆ6ä¸ªè¾“å‡ºèŠ‚ç‚¹
```

**ç‰¹ç‚¹**:
- æœ€å¤æ‚çš„ç¼–ç æ–¹å¼
- å…±äº«åŸºå› ç»„ï¼ŒååŒè¿›åŒ–
- å‚æ•°æ•ˆç‡é«˜ï¼Œä½†è®­ç»ƒæ…¢

### ğŸ”„ è¿›åŒ–è¿‡ç¨‹

æ‰€æœ‰ç½‘ç»œéƒ½ä½¿ç”¨ç›¸åŒçš„NEATè¿›åŒ–ç®—æ³•ï¼š

```python
# 1. è¯„ä¼°ç§ç¾¤
for genome in population:
    if net_type == 'recurrent':
        net = RecurrentNet.create(genome, config)
    elif net_type == 'adaptive_linear':
        net = AdaptiveLinearNet.create(genome, config, coords...)
    elif net_type == 'adaptive':
        net = AdaptiveNet.create(genome, config, coords...)
    
    fitness = evaluate(net, env)
    genome.fitness = fitness

# 2. é€‰æ‹©
parents = select_best(population)

# 3. ç¹æ®–ï¼ˆäº¤å‰ã€å˜å¼‚ï¼‰
offspring = reproduce(parents)

# 4. ç‰©ç§åˆ’åˆ†
speciate(offspring)

# 5. ä¸‹ä¸€ä»£
population = offspring
```

### ğŸ“Š åŸºå› ç»„å¤æ‚åº¦å¯¹æ¯”

| ç½‘ç»œç±»å‹ | å…¸å‹èŠ‚ç‚¹æ•° | å…¸å‹è¿æ¥æ•° | å‚æ•°é‡ | è¿›åŒ–ä»£æ•° |
|---------|-----------|-----------|-------|---------|
| RecurrentNet | 5-20 | 10-50 | ç›´æ¥ç¼–ç  | 100-500 |
| AdaptiveLinearNet | 3-10 | 5-20 | é—´æ¥ç¼–ç  | 500-2000 |
| AdaptiveNet | 5-15 | 10-40 | é—´æ¥ç¼–ç  | 1000-5000 |

**è¯´æ˜**:
- èŠ‚ç‚¹æ•°: CPPNçš„å†…éƒ¨èŠ‚ç‚¹æ•°ï¼ˆä¸æ˜¯ç½‘ç»œçš„ç¥ç»å…ƒæ•°ï¼‰
- è¿æ¥æ•°: CPPNçš„å†…éƒ¨è¿æ¥æ•°
- å‚æ•°é‡: ç›´æ¥ç¼–ç =è¿æ¥æ•°ï¼Œé—´æ¥ç¼–ç â‰ˆèŠ‚ç‚¹æ•°Ã—è¿æ¥æ•°
- è¿›åŒ–ä»£æ•°: å…¸å‹ä»»åŠ¡éœ€è¦çš„ä»£æ•°

---

## ç»Ÿä¸€æ¥å£è®¾è®¡

ä¸ºäº†æ–¹ä¾¿é€šè¿‡å‘½ä»¤è¡Œå‚æ•°é€‰æ‹©ç½‘ç»œç±»å‹ï¼Œæˆ‘ä»¬è®¾è®¡äº†ç»Ÿä¸€çš„æ¥å£ã€‚

### ğŸ¨ è®¾è®¡åŸåˆ™

1. **ç»Ÿä¸€çš„åˆ›å»ºæ¥å£**: æ‰€æœ‰ç½‘ç»œé€šè¿‡ç›¸åŒçš„å‡½æ•°åˆ›å»º
2. **ç»Ÿä¸€çš„ä½¿ç”¨æ¥å£**: æ‰€æœ‰ç½‘ç»œæœ‰ç›¸åŒçš„æ–¹æ³•ï¼ˆactivate, resetï¼‰
3. **çµæ´»çš„é…ç½®**: é€šè¿‡é…ç½®æ–‡ä»¶æˆ–å‘½ä»¤è¡Œå‚æ•°é€‰æ‹©ç½‘ç»œç±»å‹
4. **å…¼å®¹æ€§**: è‡ªåŠ¨å¤„ç†ä¸åŒç½‘ç»œçš„ç‰¹æ®Šå‚æ•°

### ğŸ“¦ å®ç°æ–¹æ¡ˆ

å‚è§ `docs/unified_network_interface.py` ä¸­çš„å®Œæ•´å®ç°ã€‚

#### æ ¸å¿ƒåŠŸèƒ½

```python
# åˆ›å»ºç½‘ç»œå·¥å‚
def create_network(net_type, genome, config, **kwargs):
    """ç»Ÿä¸€çš„ç½‘ç»œåˆ›å»ºæ¥å£"""
    if net_type == 'recurrent':
        return RecurrentNet.create(genome, config, ...)
    elif net_type == 'adaptive_linear':
        return AdaptiveLinearNet.create(genome, config, ...)
    elif net_type == 'adaptive':
        return AdaptiveNet.create(genome, config, ...)

# é…ç½®ç®¡ç†
class NetworkConfig:
    """ç½‘ç»œé…ç½®ç±»"""
    def __init__(self):
        self.net_type = 'recurrent'
        self.activation = 'tanh'
        # ...

# å‘½ä»¤è¡Œæ¥å£
python train.py --net_type recurrent --activation tanh
python train.py --net_type adaptive_linear --input_coords "[-1,0],[0,0],[1,0]"
python train.py --net_type adaptive --n_hidden 5
```

### ğŸ”§ é…ç½®æ–‡ä»¶æ ¼å¼

```yaml
# network_config.yaml
network:
  type: recurrent  # recurrent | adaptive_linear | adaptive
  
  # é€šç”¨å‚æ•°
  activation: tanh
  batch_size: 4
  device: cpu
  
  # RecurrentNetç‰¹å®šå‚æ•°
  recurrent:
    n_internal_steps: 1
    use_current_activs: false
  
  # AdaptiveLinearNetç‰¹å®šå‚æ•°
  adaptive_linear:
    input_coords: [[-1, 0], [0, 0], [1, 0]]
    output_coords: [[-1, 0], [0, 0], [1, 0]]
    weight_threshold: 0.4
    weight_max: 3.0
  
  # AdaptiveNetç‰¹å®šå‚æ•°
  adaptive:
    input_coords: [[-1, 0], [0, 0], [1, 0]]
    hidden_coords: [[0, 0.5]]
    output_coords: [[-1, 1], [0, 1], [1, 1]]
    weight_threshold: 0.2
```

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: å‘½ä»¤è¡Œåˆ‡æ¢ç½‘ç»œ

```bash
# ä½¿ç”¨é€’å½’ç½‘ç»œè®­ç»ƒCartPole
python examples/train.py \
  --task cartpole \
  --net_type recurrent \
  --n_generations 100

# ä½¿ç”¨è‡ªé€‚åº”çº¿æ€§ç½‘ç»œè®­ç»ƒT-Maze
python examples/train.py \
  --task tmaze \
  --net_type adaptive_linear \
  --n_generations 1000 \
  --batch_size 4

# ä½¿ç”¨è‡ªé€‚åº”é€’å½’ç½‘ç»œè®­ç»ƒå¤æ‚ä»»åŠ¡
python examples/train.py \
  --task complex \
  --net_type adaptive \
  --n_generations 5000 \
  --device cuda:0
```

### ç¤ºä¾‹2: ç›¸åŒä»»åŠ¡ä¸åŒç½‘ç»œ

```python
# CartPole - ä¸‰ç§ç½‘ç»œå¯¹æ¯”
import gym
from pytorch_neat import *

env = gym.make('CartPole-v1')

# æ–¹å¼1: RecurrentNetï¼ˆæœ€å¿«ï¼‰
net1 = RecurrentNet.create(genome, config)
# æ–¹å¼2: AdaptiveLinearNetï¼ˆä¸­ç­‰ï¼‰
net2 = AdaptiveLinearNet.create(
    genome, config,
    input_coords=[[-1,0], [0,0], [1,0], [0,-1]],
    output_coords=[[0,0]]
)
# æ–¹å¼3: AdaptiveNetï¼ˆæœ€æ…¢ï¼‰
net3 = AdaptiveNet.create(
    genome, config,
    input_coords=[[-1,0], [0,0], [1,0], [0,-1]],
    hidden_coords=[[0,0.5]],
    output_coords=[[0,1]]
)

# ä½¿ç”¨ç›¸åŒçš„è¯„ä¼°ä»£ç 
for net in [net1, net2, net3]:
    net.reset()
    state = env.reset()[0]
    total_reward = 0
    
    for _ in range(500):
        output = net.activate([state])
        action = int(output[0, 0] > 0.5)
        state, reward, done, truncated, _ = env.step(action)
        total_reward += reward
        if done or truncated:
            break
    
    print(f"Total reward: {total_reward}")
```

### ç¤ºä¾‹3: é…ç½®æ–‡ä»¶é©±åŠ¨

```python
# ä»é…ç½®æ–‡ä»¶åŠ è½½
import yaml
from unified_network_interface import NetworkConfig, create_network

# åŠ è½½é…ç½®
with open('network_config.yaml') as f:
    config_dict = yaml.safe_load(f)

net_config = NetworkConfig.from_dict(config_dict['network'])

# åˆ›å»ºç½‘ç»œ
net = create_network(
    net_type=net_config.net_type,
    genome=genome,
    config=neat_config,
    **net_config.get_network_params()
)

# ä½¿ç”¨ç½‘ç»œ
outputs = net.activate(states)
```

---

## æ€§èƒ½å¯¹æ¯”

### â±ï¸ è®¡ç®—æ—¶é—´å¯¹æ¯”

åœ¨Intel i7-10700K CPUä¸Šï¼Œbatch_size=4ï¼š

| ä»»åŠ¡ | RecurrentNet | AdaptiveLinearNet | AdaptiveNet |
|------|-------------|-------------------|-------------|
| CartPole (4è¾“å…¥, 1è¾“å‡º) | 0.5 ms | 1.2 ms | 3.5 ms |
| T-Maze (4è¾“å…¥, 3è¾“å‡º) | 0.8 ms | 2.0 ms | 5.2 ms |
| å¤æ‚ä»»åŠ¡ (10è¾“å…¥, 10éšè—, 5è¾“å‡º) | 1.5 ms | - | 15.0 ms |

### ğŸ¯ ä»»åŠ¡è¡¨ç°å¯¹æ¯”

| ä»»åŠ¡ | éš¾åº¦ | RecurrentNet | AdaptiveLinearNet | AdaptiveNet |
|------|------|-------------|-------------------|-------------|
| CartPole | ç®€å• | â­â­â­â­â­ ä¼˜ç§€ | â­â­â­â­ è‰¯å¥½ | â­â­â­â­ è‰¯å¥½ |
| T-Maze | ä¸­ç­‰ | â­â­ å›°éš¾ | â­â­â­â­â­ ä¼˜ç§€ | â­â­â­â­â­ ä¼˜ç§€ |
| é•¿åºåˆ—è®°å¿† | å›°éš¾ | â­â­ å›°éš¾ | â­â­â­ ä¸­ç­‰ | â­â­â­â­â­ ä¼˜ç§€ |
| éå¹³ç¨³ç¯å¢ƒ | å›°éš¾ | â­ å¾ˆéš¾ | â­â­â­â­ è‰¯å¥½ | â­â­â­â­â­ ä¼˜ç§€ |

### ğŸ“ˆ è®­ç»ƒæ•ˆç‡å¯¹æ¯”

| ç½‘ç»œç±»å‹ | æ¯ä»£æ—¶é—´ | æ”¶æ•›ä»£æ•° | æ€»è®­ç»ƒæ—¶é—´ |
|---------|---------|---------|----------|
| RecurrentNet | 1x | 1x | 1x (åŸºå‡†) |
| AdaptiveLinearNet | 2.5x | 3x | 7.5x |
| AdaptiveNet | 7x | 10x | 70x |

**è¯´æ˜**: æ—¶é—´æ˜¯ç›¸å¯¹äºRecurrentNetçš„å€æ•°

---

## é€‰æ‹©æŒ‡å—

### ğŸ¯ å†³ç­–æ ‘

```
å¼€å§‹
 â”‚
 â”œâ”€ éœ€è¦è‡ªé€‚åº”/åœ¨çº¿å­¦ä¹ ï¼Ÿ
 â”‚   â”œâ”€ å¦ â†’ RecurrentNet
 â”‚   â””â”€ æ˜¯ â†’ ç»§ç»­
 â”‚
 â”œâ”€ ä»»åŠ¡å¤æ‚åº¦ï¼Ÿ
 â”‚   â”œâ”€ ç®€å•ï¼ˆè¾“å…¥è¾“å‡ºå°‘ï¼Œæ— é•¿æœŸä¾èµ–ï¼‰
 â”‚   â”‚   â””â”€ AdaptiveLinearNet
 â”‚   â””â”€ å¤æ‚ï¼ˆéœ€è¦å¤æ‚æ¨ç†ï¼Œé•¿æœŸè®°å¿†ï¼‰
 â”‚       â””â”€ AdaptiveNet
 â”‚
 â”œâ”€ è®¡ç®—èµ„æºï¼Ÿ
 â”‚   â”œâ”€ æœ‰é™ â†’ RecurrentNet
 â”‚   â””â”€ å……è¶³ â†’ è‡ªé€‚åº”ç½‘ç»œ
 â”‚
 â””â”€ ç ”ç©¶ç›®æ ‡ï¼Ÿ
     â”œâ”€ å¿«é€Ÿå®éªŒ/baseline â†’ RecurrentNet
     â”œâ”€ ç ”ç©¶è‡ªé€‚åº”æœºåˆ¶ â†’ AdaptiveLinearNet
     â””â”€ æ¢ç´¢å‰æ²¿æ–¹æ³• â†’ AdaptiveNet
```

### ğŸ“‹ å¿«é€Ÿé€‰æ‹©è¡¨

**åœºæ™¯ â†’ æ¨èç½‘ç»œ**

| åœºæ™¯ | æ¨è | åŸå›  |
|------|------|------|
| å­¦ä¹ NEAT | RecurrentNet | ç®€å•ç›´è§‚ |
| ç®€å•æ§åˆ¶ä»»åŠ¡ | RecurrentNet | è¶³å¤Ÿä¸”å¿«é€Ÿ |
| T-Mazeç±»è®°å¿†ä»»åŠ¡ | AdaptiveLinearNet | ä¸“é—¨è®¾è®¡ |
| ç¯å¢ƒä¼šå˜åŒ– | AdaptiveLinearNet/AdaptiveNet | è‡ªé€‚åº”èƒ½åŠ› |
| éœ€è¦å¤æ‚æ¨ç† | AdaptiveNet | è¡¨è¾¾èƒ½åŠ›å¼º |
| å¤§è§„æ¨¡å®éªŒ | RecurrentNet | è¯„ä¼°å¿«é€Ÿ |
| å…ƒå­¦ä¹ ç ”ç©¶ | AdaptiveNet | å­¦ä¼šå­¦ä¹  |
| èµ„æºå—é™ | RecurrentNet | å†…å­˜å’Œè®¡ç®—å° |
| å‘è¡¨è®ºæ–‡ | AdaptiveNet | æ–°é¢–æ€§é«˜ |

### ğŸ’¡ æ··åˆç­–ç•¥

å¯ä»¥åœ¨ç ”ç©¶ä¸­ç»“åˆä½¿ç”¨ï¼š

1. **Baselineå…ˆè¡Œ**: å…ˆç”¨RecurrentNetå»ºç«‹baseline
2. **é€æ­¥å‡çº§**: å¦‚æœæ€§èƒ½ä¸å¤Ÿï¼Œå°è¯•AdaptiveLinearNet
3. **ç»ˆææ–¹æ¡ˆ**: å¤æ‚ä»»åŠ¡æœ€åè¯•AdaptiveNet
4. **å¯¹æ¯”ç ”ç©¶**: ä¸‰ç§ç½‘ç»œéƒ½è¯•ï¼Œåˆ†æå·®å¼‚
5. **ä»»åŠ¡å®šåˆ¶**: æ ¹æ®ä»»åŠ¡ç‰¹ç‚¹ä¿®æ”¹ç½‘ç»œ

---

## æ€»ç»“

### ğŸ“ å…³é”®è¦ç‚¹

1. **RecurrentNet**: ç®€å•å¿«é€Ÿï¼Œé€‚åˆå¤§å¤šæ•°ä»»åŠ¡ï¼Œé¦–é€‰
2. **AdaptiveLinearNet**: è‡ªé€‚åº”ä½†ç®€å•ï¼Œé€‚åˆè®°å¿†ä»»åŠ¡
3. **AdaptiveNet**: æœ€å¼ºå¤§ä½†æœ€æ…¢ï¼Œé€‚åˆå¤æ‚ç ”ç©¶

### ğŸš€ å¼€å§‹ä½¿ç”¨

```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. å¿«é€Ÿå¼€å§‹ï¼ˆRecurrentNetï¼‰
cd examples/simple
python main.py --n_generations 100

# 3. å°è¯•è‡ªé€‚åº”ï¼ˆAdaptiveLinearNetï¼‰
cd examples/adaptive
python main.py --n_generations 1000

# 4. ä½¿ç”¨ç»Ÿä¸€æ¥å£
python examples/unified_train.py --net_type recurrent
python examples/unified_train.py --net_type adaptive_linear
python examples/unified_train.py --net_type adaptive
```

### ğŸ“š è¿›ä¸€æ­¥å­¦ä¹ 

- æŸ¥çœ‹ `examples/` ç›®å½•ä¸­çš„ç¤ºä¾‹
- é˜…è¯»å„ä¸ªç½‘ç»œæ–‡ä»¶çš„è¯¦ç»†æ³¨é‡Š
- å‚è€ƒ `docs/unified_network_interface.py` çš„å®ç°
- å®éªŒä¸åŒçš„è¶…å‚æ•°ç»„åˆ

### ğŸ¤ è´¡çŒ®

æ¬¢è¿æå‡ºé—®é¢˜ã€å»ºè®®å’Œæ”¹è¿›ï¼

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-01-21  
**ç»´æŠ¤è€…**: PyTorch-NEAT Team

